/* File: miccs_coremodule.c
 * This file is auto-generated with f2py (version:2).
 * f2py is a Fortran to Python Interface Generator (FPIG), Second Edition,
 * written by Pearu Peterson <pearu@cens.ioc.ee>.
 * Generation date: Thu Apr 25 17:08:54 2019
 * Do not edit this file directly unless you know what you are doing!!!
 */

#ifdef __cplusplus
extern "C" {
#endif

/*********************** See f2py2e/cfuncs.py: includes ***********************/
#include "Python.h"
#include <stdarg.h>
#include "fortranobject.h"
#include <math.h>

/**************** See f2py2e/rules.py: mod_rules['modulebody'] ****************/
static PyObject *miccs_core_error;
static PyObject *miccs_core_module;

/*********************** See f2py2e/cfuncs.py: typedefs ***********************/
/*need_typedefs*/

/****************** See f2py2e/cfuncs.py: typedefs_generated ******************/
/*need_typedefs_generated*/

/********************** See f2py2e/cfuncs.py: cppmacros **********************/
#if defined(PREPEND_FORTRAN)
#if defined(NO_APPEND_FORTRAN)
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) _##F
#else
#define F_FUNC(f,F) _##f
#endif
#else
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) _##F##_
#else
#define F_FUNC(f,F) _##f##_
#endif
#endif
#else
#if defined(NO_APPEND_FORTRAN)
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) F
#else
#define F_FUNC(f,F) f
#endif
#else
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) F##_
#else
#define F_FUNC(f,F) f##_
#endif
#endif
#endif
#if defined(UNDERSCORE_G77)
#define F_FUNC_US(f,F) F_FUNC(f##_,F##_)
#else
#define F_FUNC_US(f,F) F_FUNC(f,F)
#endif

#define rank(var) var ## _Rank
#define shape(var,dim) var ## _Dims[dim]
#define old_rank(var) (PyArray_NDIM((PyArrayObject *)(capi_ ## var ## _tmp)))
#define old_shape(var,dim) PyArray_DIM(((PyArrayObject *)(capi_ ## var ## _tmp)),dim)
#define fshape(var,dim) shape(var,rank(var)-dim-1)
#define len(var) shape(var,0)
#define flen(var) fshape(var,0)
#define old_size(var) PyArray_SIZE((PyArrayObject *)(capi_ ## var ## _tmp))
/* #define index(i) capi_i ## i */
#define slen(var) capi_ ## var ## _len
#define size(var, ...) f2py_size((PyArrayObject *)(capi_ ## var ## _tmp), ## __VA_ARGS__, -1)

#define CHECKSCALAR(check,tcheck,name,show,var)\
    if (!(check)) {\
        char errstring[256];\
        sprintf(errstring, "%s: "show, "("tcheck") failed for "name, var);\
        PyErr_SetString(miccs_core_error,errstring);\
        /*goto capi_fail;*/\
    } else 
#ifdef DEBUGCFUNCS
#define CFUNCSMESS(mess) fprintf(stderr,"debug-capi:"mess);
#define CFUNCSMESSPY(mess,obj) CFUNCSMESS(mess) \
    PyObject_Print((PyObject *)obj,stderr,Py_PRINT_RAW);\
    fprintf(stderr,"\n");
#else
#define CFUNCSMESS(mess)
#define CFUNCSMESSPY(mess,obj)
#endif

#ifndef max
#define max(a,b) ((a > b) ? (a) : (b))
#endif
#ifndef min
#define min(a,b) ((a < b) ? (a) : (b))
#endif
#ifndef MAX
#define MAX(a,b) ((a > b) ? (a) : (b))
#endif
#ifndef MIN
#define MIN(a,b) ((a < b) ? (a) : (b))
#endif


/************************ See f2py2e/cfuncs.py: cfuncs ************************/
static int f2py_size(PyArrayObject* var, ...)
{
  npy_int sz = 0;
  npy_int dim;
  npy_int rank;
  va_list argp;
  va_start(argp, var);
  dim = va_arg(argp, npy_int);
  if (dim==-1)
    {
      sz = PyArray_SIZE(var);
    }
  else
    {
      rank = PyArray_NDIM(var);
      if (dim>=1 && dim<=rank)
        sz = PyArray_DIM(var, dim-1);
      else
        fprintf(stderr, "f2py_size: 2nd argument value=%d fails to satisfy 1<=value<=%d. Result will be 0.\n", dim, rank);
    }
  va_end(argp);
  return sz;
}

static int double_from_pyobj(double* v,PyObject *obj,const char *errmess) {
    PyObject* tmp = NULL;
    if (PyFloat_Check(obj)) {
#ifdef __sgi
        *v = PyFloat_AsDouble(obj);
#else
        *v = PyFloat_AS_DOUBLE(obj);
#endif
        return 1;
    }
    tmp = PyNumber_Float(obj);
    if (tmp) {
#ifdef __sgi
        *v = PyFloat_AsDouble(tmp);
#else
        *v = PyFloat_AS_DOUBLE(tmp);
#endif
        Py_DECREF(tmp);
        return 1;
    }
    if (PyComplex_Check(obj))
        tmp = PyObject_GetAttrString(obj,"real");
    else if (PyString_Check(obj) || PyUnicode_Check(obj))
        /*pass*/;
    else if (PySequence_Check(obj))
        tmp = PySequence_GetItem(obj,0);
    if (tmp) {
        PyErr_Clear();
        if (double_from_pyobj(v,tmp,errmess)) {Py_DECREF(tmp); return 1;}
        Py_DECREF(tmp);
    }
    {
        PyObject* err = PyErr_Occurred();
        if (err==NULL) err = miccs_core_error;
        PyErr_SetString(err,errmess);
    }
    return 0;
}

static int int_from_pyobj(int* v,PyObject *obj,const char *errmess) {
    PyObject* tmp = NULL;
    if (PyInt_Check(obj)) {
        *v = (int)PyInt_AS_LONG(obj);
        return 1;
    }
    tmp = PyNumber_Int(obj);
    if (tmp) {
        *v = PyInt_AS_LONG(tmp);
        Py_DECREF(tmp);
        return 1;
    }
    if (PyComplex_Check(obj))
        tmp = PyObject_GetAttrString(obj,"real");
    else if (PyString_Check(obj) || PyUnicode_Check(obj))
        /*pass*/;
    else if (PySequence_Check(obj))
        tmp = PySequence_GetItem(obj,0);
    if (tmp) {
        PyErr_Clear();
        if (int_from_pyobj(v,tmp,errmess)) {Py_DECREF(tmp); return 1;}
        Py_DECREF(tmp);
    }
    {
        PyObject* err = PyErr_Occurred();
        if (err==NULL) err = miccs_core_error;
        PyErr_SetString(err,errmess);
    }
    return 0;
}


/********************* See f2py2e/cfuncs.py: userincludes *********************/
/*need_userincludes*/

/********************* See f2py2e/capi_rules.py: usercode *********************/


/* See f2py2e/rules.py */
extern void F_FUNC_US(optimize_once,OPTIMIZE_ONCE)(double*,double*,double*,double*,double*,double*,int*,int*,int*,double*,double*,double*,int*,int*,int*);
/*eof externroutines*/

/******************** See f2py2e/capi_rules.py: usercode1 ********************/


/******************* See f2py2e/cb_rules.py: buildcallback *******************/
/*need_callbacks*/

/*********************** See f2py2e/rules.py: buildapi ***********************/

/******************************* optimize_once *******************************/
static char doc_f2py_rout_miccs_core_optimize_once[] = "\
cost = optimize_once(prec,weight,latent,corr,obs,ind,full_graph,smooth_graph,lglasso,lridge,lsmooth,[npop,dtot,nobs])\n\nWrapper for ``optimize_once``.\
\n\nParameters\n----------\n"
"prec :  rank-2 array('d') with bounds (npop,npop)\n"
"weight :  rank-1 array('d') with bounds (dtot)\n"
"latent :  rank-2 array('d') with bounds (npop,nobs)\n"
"corr :  rank-2 array('d') with bounds (npop,npop)\n"
"obs : input rank-2 array('d') with bounds (dtot,nobs)\n"
"ind : input rank-1 array('i') with bounds (npop + 1)\n"
"full_graph : input rank-2 array('i') with bounds (npop,npop)\n"
"smooth_graph : input rank-2 array('i') with bounds (npop,npop)\n"
"lglasso : input float\n"
"lridge : input float\n"
"lsmooth : input float\n"
"\nOther Parameters\n----------------\n"
"npop : input int, optional\n    Default: shape(prec,0)\n"
"dtot : input int, optional\n    Default: len(weight)\n"
"nobs : input int, optional\n    Default: shape(latent,1)\n"
"\nReturns\n-------\n"
"cost : float";
/* extern void F_FUNC_US(optimize_once,OPTIMIZE_ONCE)(double*,double*,double*,double*,double*,double*,int*,int*,int*,double*,double*,double*,int*,int*,int*); */
static PyObject *f2py_rout_miccs_core_optimize_once(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,double*,double*,int*,int*,int*,double*,double*,double*,int*,int*,int*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  double cost = 0;
  double *prec = NULL;
  npy_intp prec_Dims[2] = {-1, -1};
  const int prec_Rank = 2;
  PyArrayObject *capi_prec_tmp = NULL;
  int capi_prec_intent = 0;
  PyObject *prec_capi = Py_None;
  double *weight = NULL;
  npy_intp weight_Dims[1] = {-1};
  const int weight_Rank = 1;
  PyArrayObject *capi_weight_tmp = NULL;
  int capi_weight_intent = 0;
  PyObject *weight_capi = Py_None;
  double *latent = NULL;
  npy_intp latent_Dims[2] = {-1, -1};
  const int latent_Rank = 2;
  PyArrayObject *capi_latent_tmp = NULL;
  int capi_latent_intent = 0;
  PyObject *latent_capi = Py_None;
  double *corr = NULL;
  npy_intp corr_Dims[2] = {-1, -1};
  const int corr_Rank = 2;
  PyArrayObject *capi_corr_tmp = NULL;
  int capi_corr_intent = 0;
  PyObject *corr_capi = Py_None;
  double *obs = NULL;
  npy_intp obs_Dims[2] = {-1, -1};
  const int obs_Rank = 2;
  PyArrayObject *capi_obs_tmp = NULL;
  int capi_obs_intent = 0;
  PyObject *obs_capi = Py_None;
  int *ind = NULL;
  npy_intp ind_Dims[1] = {-1};
  const int ind_Rank = 1;
  PyArrayObject *capi_ind_tmp = NULL;
  int capi_ind_intent = 0;
  PyObject *ind_capi = Py_None;
  int *full_graph = NULL;
  npy_intp full_graph_Dims[2] = {-1, -1};
  const int full_graph_Rank = 2;
  PyArrayObject *capi_full_graph_tmp = NULL;
  int capi_full_graph_intent = 0;
  PyObject *full_graph_capi = Py_None;
  int *smooth_graph = NULL;
  npy_intp smooth_graph_Dims[2] = {-1, -1};
  const int smooth_graph_Rank = 2;
  PyArrayObject *capi_smooth_graph_tmp = NULL;
  int capi_smooth_graph_intent = 0;
  PyObject *smooth_graph_capi = Py_None;
  double lglasso = 0;
  PyObject *lglasso_capi = Py_None;
  double lridge = 0;
  PyObject *lridge_capi = Py_None;
  double lsmooth = 0;
  PyObject *lsmooth_capi = Py_None;
  int npop = 0;
  PyObject *npop_capi = Py_None;
  int dtot = 0;
  PyObject *dtot_capi = Py_None;
  int nobs = 0;
  PyObject *nobs_capi = Py_None;
  static char *capi_kwlist[] = {"prec","weight","latent","corr","obs","ind","full_graph","smooth_graph","lglasso","lridge","lsmooth","npop","dtot","nobs",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOOOOOOOO|OOO:miccs_core.optimize_once",\
    capi_kwlist,&prec_capi,&weight_capi,&latent_capi,&corr_capi,&obs_capi,&ind_capi,&full_graph_capi,&smooth_graph_capi,&lglasso_capi,&lridge_capi,&lsmooth_capi,&npop_capi,&dtot_capi,&nobs_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable lglasso */
    f2py_success = double_from_pyobj(&lglasso,lglasso_capi,"miccs_core.optimize_once() 9th argument (lglasso) can't be converted to double");
  if (f2py_success) {
  /* Processing variable lridge */
    f2py_success = double_from_pyobj(&lridge,lridge_capi,"miccs_core.optimize_once() 10th argument (lridge) can't be converted to double");
  if (f2py_success) {
  /* Processing variable lsmooth */
    f2py_success = double_from_pyobj(&lsmooth,lsmooth_capi,"miccs_core.optimize_once() 11st argument (lsmooth) can't be converted to double");
  if (f2py_success) {
  /* Processing variable prec */
  ;
  capi_prec_intent |= F2PY_INTENT_INPLACE;
  capi_prec_tmp = array_from_pyobj(NPY_DOUBLE,prec_Dims,prec_Rank,capi_prec_intent,prec_capi);
  if (capi_prec_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 1st argument `prec' of miccs_core.optimize_once to C/Fortran array" );
  } else {
    prec = (double *)(PyArray_DATA(capi_prec_tmp));

  /* Processing variable weight */
  ;
  capi_weight_intent |= F2PY_INTENT_INPLACE;
  capi_weight_tmp = array_from_pyobj(NPY_DOUBLE,weight_Dims,weight_Rank,capi_weight_intent,weight_capi);
  if (capi_weight_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 2nd argument `weight' of miccs_core.optimize_once to C/Fortran array" );
  } else {
    weight = (double *)(PyArray_DATA(capi_weight_tmp));

  /* Processing variable cost */
  /* Processing variable npop */
  if (npop_capi == Py_None) npop = shape(prec,0); else
    f2py_success = int_from_pyobj(&npop,npop_capi,"miccs_core.optimize_once() 1st keyword (npop) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(prec,0)==npop,"shape(prec,0)==npop","1st keyword npop","optimize_once:npop=%d",npop) {
  /* Processing variable dtot */
  if (dtot_capi == Py_None) dtot = len(weight); else
    f2py_success = int_from_pyobj(&dtot,dtot_capi,"miccs_core.optimize_once() 2nd keyword (dtot) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(len(weight)>=dtot,"len(weight)>=dtot","2nd keyword dtot","optimize_once:dtot=%d",dtot) {
  /* Processing variable ind */
  ind_Dims[0]=npop + 1;
  capi_ind_intent |= F2PY_INTENT_IN;
  capi_ind_tmp = array_from_pyobj(NPY_INT,ind_Dims,ind_Rank,capi_ind_intent,ind_capi);
  if (capi_ind_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 6th argument `ind' of miccs_core.optimize_once to C/Fortran array" );
  } else {
    ind = (int *)(PyArray_DATA(capi_ind_tmp));

  /* Processing variable full_graph */
  full_graph_Dims[0]=npop,full_graph_Dims[1]=npop;
  capi_full_graph_intent |= F2PY_INTENT_IN;
  capi_full_graph_tmp = array_from_pyobj(NPY_INT,full_graph_Dims,full_graph_Rank,capi_full_graph_intent,full_graph_capi);
  if (capi_full_graph_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 7th argument `full_graph' of miccs_core.optimize_once to C/Fortran array" );
  } else {
    full_graph = (int *)(PyArray_DATA(capi_full_graph_tmp));

  /* Processing variable smooth_graph */
  smooth_graph_Dims[0]=npop,smooth_graph_Dims[1]=npop;
  capi_smooth_graph_intent |= F2PY_INTENT_IN;
  capi_smooth_graph_tmp = array_from_pyobj(NPY_INT,smooth_graph_Dims,smooth_graph_Rank,capi_smooth_graph_intent,smooth_graph_capi);
  if (capi_smooth_graph_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 8th argument `smooth_graph' of miccs_core.optimize_once to C/Fortran array" );
  } else {
    smooth_graph = (int *)(PyArray_DATA(capi_smooth_graph_tmp));

  /* Processing variable corr */
  corr_Dims[0]=npop,corr_Dims[1]=npop;
  capi_corr_intent |= F2PY_INTENT_INPLACE;
  capi_corr_tmp = array_from_pyobj(NPY_DOUBLE,corr_Dims,corr_Rank,capi_corr_intent,corr_capi);
  if (capi_corr_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 4th argument `corr' of miccs_core.optimize_once to C/Fortran array" );
  } else {
    corr = (double *)(PyArray_DATA(capi_corr_tmp));

  /* Processing variable latent */
  latent_Dims[0]=npop;
  capi_latent_intent |= F2PY_INTENT_INPLACE;
  capi_latent_tmp = array_from_pyobj(NPY_DOUBLE,latent_Dims,latent_Rank,capi_latent_intent,latent_capi);
  if (capi_latent_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 3rd argument `latent' of miccs_core.optimize_once to C/Fortran array" );
  } else {
    latent = (double *)(PyArray_DATA(capi_latent_tmp));

  /* Processing variable nobs */
  if (nobs_capi == Py_None) nobs = shape(latent,1); else
    f2py_success = int_from_pyobj(&nobs,nobs_capi,"miccs_core.optimize_once() 3rd keyword (nobs) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(latent,1)==nobs,"shape(latent,1)==nobs","3rd keyword nobs","optimize_once:nobs=%d",nobs) {
  /* Processing variable obs */
  obs_Dims[0]=dtot,obs_Dims[1]=nobs;
  capi_obs_intent |= F2PY_INTENT_IN;
  capi_obs_tmp = array_from_pyobj(NPY_DOUBLE,obs_Dims,obs_Rank,capi_obs_intent,obs_capi);
  if (capi_obs_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 5th argument `obs' of miccs_core.optimize_once to C/Fortran array" );
  } else {
    obs = (double *)(PyArray_DATA(capi_obs_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&cost,prec,weight,latent,corr,obs,ind,full_graph,smooth_graph,&lglasso,&lridge,&lsmooth,&npop,&dtot,&nobs);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("d",cost);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  if((PyObject *)capi_obs_tmp!=obs_capi) {
    Py_XDECREF(capi_obs_tmp); }
  }  /*if (capi_obs_tmp == NULL) ... else of obs*/
  /* End of cleaning variable obs */
  } /*CHECKSCALAR(shape(latent,1)==nobs)*/
  } /*if (f2py_success) of nobs*/
  /* End of cleaning variable nobs */
  if((PyObject *)capi_latent_tmp!=latent_capi) {
    Py_XDECREF(capi_latent_tmp); }
  }  /*if (capi_latent_tmp == NULL) ... else of latent*/
  /* End of cleaning variable latent */
  if((PyObject *)capi_corr_tmp!=corr_capi) {
    Py_XDECREF(capi_corr_tmp); }
  }  /*if (capi_corr_tmp == NULL) ... else of corr*/
  /* End of cleaning variable corr */
  if((PyObject *)capi_smooth_graph_tmp!=smooth_graph_capi) {
    Py_XDECREF(capi_smooth_graph_tmp); }
  }  /*if (capi_smooth_graph_tmp == NULL) ... else of smooth_graph*/
  /* End of cleaning variable smooth_graph */
  if((PyObject *)capi_full_graph_tmp!=full_graph_capi) {
    Py_XDECREF(capi_full_graph_tmp); }
  }  /*if (capi_full_graph_tmp == NULL) ... else of full_graph*/
  /* End of cleaning variable full_graph */
  if((PyObject *)capi_ind_tmp!=ind_capi) {
    Py_XDECREF(capi_ind_tmp); }
  }  /*if (capi_ind_tmp == NULL) ... else of ind*/
  /* End of cleaning variable ind */
  } /*CHECKSCALAR(len(weight)>=dtot)*/
  } /*if (f2py_success) of dtot*/
  /* End of cleaning variable dtot */
  } /*CHECKSCALAR(shape(prec,0)==npop)*/
  } /*if (f2py_success) of npop*/
  /* End of cleaning variable npop */
  /* End of cleaning variable cost */
  if((PyObject *)capi_weight_tmp!=weight_capi) {
    Py_XDECREF(capi_weight_tmp); }
  }  /*if (capi_weight_tmp == NULL) ... else of weight*/
  /* End of cleaning variable weight */
  if((PyObject *)capi_prec_tmp!=prec_capi) {
    Py_XDECREF(capi_prec_tmp); }
  }  /*if (capi_prec_tmp == NULL) ... else of prec*/
  /* End of cleaning variable prec */
  } /*if (f2py_success) of lsmooth*/
  /* End of cleaning variable lsmooth */
  } /*if (f2py_success) of lridge*/
  /* End of cleaning variable lridge */
  } /*if (f2py_success) of lglasso*/
  /* End of cleaning variable lglasso */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/**************************** end of optimize_once ****************************/

/*********************************** vecmat ***********************************/
static char doc_f2py_rout_miccs_core_miccs_core_mod_vecmat[] = "\
vecmat = vecmat(x,a)\n\nWrapper for ``vecmat``.\
\n\nParameters\n----------\n"
"x : input rank-1 array('d') with bounds (f2py_x_d0)\n"
"a : input rank-2 array('d') with bounds (f2py_a_d0,f2py_a_d1)\n"
"\nReturns\n-------\n"
"vecmat : rank-1 array('d') with bounds (size(a,2))";
/* #declfortranroutine# */
static PyObject *f2py_rout_miccs_core_miccs_core_mod_vecmat(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,int*,int*,int*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  double *vecmat = NULL;
  npy_intp vecmat_Dims[1] = {-1};
  const int vecmat_Rank = 1;
  PyArrayObject *capi_vecmat_tmp = NULL;
  int capi_vecmat_intent = 0;
  double *x = NULL;
  npy_intp x_Dims[1] = {-1};
  const int x_Rank = 1;
  PyArrayObject *capi_x_tmp = NULL;
  int capi_x_intent = 0;
  PyObject *x_capi = Py_None;
  double *a = NULL;
  npy_intp a_Dims[2] = {-1, -1};
  const int a_Rank = 2;
  PyArrayObject *capi_a_tmp = NULL;
  int capi_a_intent = 0;
  PyObject *a_capi = Py_None;
  int f2py_x_d0 = 0;
  int f2py_a_d0 = 0;
  int f2py_a_d1 = 0;
  static char *capi_kwlist[] = {"x","a",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OO:miccs_core.miccs_core_mod.vecmat",\
    capi_kwlist,&x_capi,&a_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable a */
  ;
  capi_a_intent |= F2PY_INTENT_IN;
  capi_a_tmp = array_from_pyobj(NPY_DOUBLE,a_Dims,a_Rank,capi_a_intent,a_capi);
  if (capi_a_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 2nd argument `a' of miccs_core.miccs_core_mod.vecmat to C/Fortran array" );
  } else {
    a = (double *)(PyArray_DATA(capi_a_tmp));

  /* Processing variable x */
  ;
  capi_x_intent |= F2PY_INTENT_IN;
  capi_x_tmp = array_from_pyobj(NPY_DOUBLE,x_Dims,x_Rank,capi_x_intent,x_capi);
  if (capi_x_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 1st argument `x' of miccs_core.miccs_core_mod.vecmat to C/Fortran array" );
  } else {
    x = (double *)(PyArray_DATA(capi_x_tmp));

  /* Processing variable vecmat */
  vecmat_Dims[0]=size(a,2);
  capi_vecmat_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_vecmat_tmp = array_from_pyobj(NPY_DOUBLE,vecmat_Dims,vecmat_Rank,capi_vecmat_intent,Py_None);
  if (capi_vecmat_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting hidden `vecmat' of miccs_core.miccs_core_mod.vecmat to C/Fortran array" );
  } else {
    vecmat = (double *)(PyArray_DATA(capi_vecmat_tmp));

  /* Processing variable f2py_x_d0 */
  f2py_x_d0 = shape(x, 0);
  /* Processing variable f2py_a_d0 */
  f2py_a_d0 = shape(a, 0);
  /* Processing variable f2py_a_d1 */
  f2py_a_d1 = shape(a, 1);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
  (*f2py_func)(vecmat,x,a,&f2py_x_d0,&f2py_a_d0,&f2py_a_d1);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("N",capi_vecmat_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable f2py_a_d1 */
  /* End of cleaning variable f2py_a_d0 */
  /* End of cleaning variable f2py_x_d0 */
  }  /*if (capi_vecmat_tmp == NULL) ... else of vecmat*/
  /* End of cleaning variable vecmat */
  if((PyObject *)capi_x_tmp!=x_capi) {
    Py_XDECREF(capi_x_tmp); }
  }  /*if (capi_x_tmp == NULL) ... else of x*/
  /* End of cleaning variable x */
  if((PyObject *)capi_a_tmp!=a_capi) {
    Py_XDECREF(capi_a_tmp); }
  }  /*if (capi_a_tmp == NULL) ... else of a*/
  /* End of cleaning variable a */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/******************************* end of vecmat *******************************/

/*********************************** matvec ***********************************/
static char doc_f2py_rout_miccs_core_miccs_core_mod_matvec[] = "\
matvec = matvec(a,x)\n\nWrapper for ``matvec``.\
\n\nParameters\n----------\n"
"a : input rank-2 array('d') with bounds (f2py_a_d0,f2py_a_d1)\n"
"x : input rank-1 array('d') with bounds (f2py_x_d0)\n"
"\nReturns\n-------\n"
"matvec : rank-1 array('d') with bounds (size(a,1))";
/* #declfortranroutine# */
static PyObject *f2py_rout_miccs_core_miccs_core_mod_matvec(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,int*,int*,int*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  double *matvec = NULL;
  npy_intp matvec_Dims[1] = {-1};
  const int matvec_Rank = 1;
  PyArrayObject *capi_matvec_tmp = NULL;
  int capi_matvec_intent = 0;
  double *a = NULL;
  npy_intp a_Dims[2] = {-1, -1};
  const int a_Rank = 2;
  PyArrayObject *capi_a_tmp = NULL;
  int capi_a_intent = 0;
  PyObject *a_capi = Py_None;
  double *x = NULL;
  npy_intp x_Dims[1] = {-1};
  const int x_Rank = 1;
  PyArrayObject *capi_x_tmp = NULL;
  int capi_x_intent = 0;
  PyObject *x_capi = Py_None;
  int f2py_a_d0 = 0;
  int f2py_a_d1 = 0;
  int f2py_x_d0 = 0;
  static char *capi_kwlist[] = {"a","x",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OO:miccs_core.miccs_core_mod.matvec",\
    capi_kwlist,&a_capi,&x_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable a */
  ;
  capi_a_intent |= F2PY_INTENT_IN;
  capi_a_tmp = array_from_pyobj(NPY_DOUBLE,a_Dims,a_Rank,capi_a_intent,a_capi);
  if (capi_a_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 1st argument `a' of miccs_core.miccs_core_mod.matvec to C/Fortran array" );
  } else {
    a = (double *)(PyArray_DATA(capi_a_tmp));

  /* Processing variable x */
  ;
  capi_x_intent |= F2PY_INTENT_IN;
  capi_x_tmp = array_from_pyobj(NPY_DOUBLE,x_Dims,x_Rank,capi_x_intent,x_capi);
  if (capi_x_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 2nd argument `x' of miccs_core.miccs_core_mod.matvec to C/Fortran array" );
  } else {
    x = (double *)(PyArray_DATA(capi_x_tmp));

  /* Processing variable matvec */
  matvec_Dims[0]=size(a,1);
  capi_matvec_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_matvec_tmp = array_from_pyobj(NPY_DOUBLE,matvec_Dims,matvec_Rank,capi_matvec_intent,Py_None);
  if (capi_matvec_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting hidden `matvec' of miccs_core.miccs_core_mod.matvec to C/Fortran array" );
  } else {
    matvec = (double *)(PyArray_DATA(capi_matvec_tmp));

  /* Processing variable f2py_a_d0 */
  f2py_a_d0 = shape(a, 0);
  /* Processing variable f2py_a_d1 */
  f2py_a_d1 = shape(a, 1);
  /* Processing variable f2py_x_d0 */
  f2py_x_d0 = shape(x, 0);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
  (*f2py_func)(matvec,a,x,&f2py_a_d0,&f2py_a_d1,&f2py_x_d0);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("N",capi_matvec_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable f2py_x_d0 */
  /* End of cleaning variable f2py_a_d1 */
  /* End of cleaning variable f2py_a_d0 */
  }  /*if (capi_matvec_tmp == NULL) ... else of matvec*/
  /* End of cleaning variable matvec */
  if((PyObject *)capi_x_tmp!=x_capi) {
    Py_XDECREF(capi_x_tmp); }
  }  /*if (capi_x_tmp == NULL) ... else of x*/
  /* End of cleaning variable x */
  if((PyObject *)capi_a_tmp!=a_capi) {
    Py_XDECREF(capi_a_tmp); }
  }  /*if (capi_a_tmp == NULL) ... else of a*/
  /* End of cleaning variable a */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/******************************* end of matvec *******************************/

/******************************* bilinear_same *******************************/
static char doc_f2py_rout_miccs_core_miccs_core_mod_bilinear_same[] = "\
bilinear_same = bilinear_same(a,x)\n\nWrapper for ``bilinear_same``.\
\n\nParameters\n----------\n"
"a : input rank-2 array('d') with bounds (f2py_a_d0,f2py_a_d1)\n"
"x : input rank-1 array('d') with bounds (f2py_x_d0)\n"
"\nReturns\n-------\n"
"bilinear_same : float";
/* #declfortranroutine# */
static PyObject *f2py_rout_miccs_core_miccs_core_mod_bilinear_same(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,int*,int*,int*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  double bilinear_same = 0;
  double *a = NULL;
  npy_intp a_Dims[2] = {-1, -1};
  const int a_Rank = 2;
  PyArrayObject *capi_a_tmp = NULL;
  int capi_a_intent = 0;
  PyObject *a_capi = Py_None;
  double *x = NULL;
  npy_intp x_Dims[1] = {-1};
  const int x_Rank = 1;
  PyArrayObject *capi_x_tmp = NULL;
  int capi_x_intent = 0;
  PyObject *x_capi = Py_None;
  int f2py_a_d0 = 0;
  int f2py_a_d1 = 0;
  int f2py_x_d0 = 0;
  static char *capi_kwlist[] = {"a","x",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OO:miccs_core.miccs_core_mod.bilinear_same",\
    capi_kwlist,&a_capi,&x_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable x */
  ;
  capi_x_intent |= F2PY_INTENT_IN;
  capi_x_tmp = array_from_pyobj(NPY_DOUBLE,x_Dims,x_Rank,capi_x_intent,x_capi);
  if (capi_x_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 2nd argument `x' of miccs_core.miccs_core_mod.bilinear_same to C/Fortran array" );
  } else {
    x = (double *)(PyArray_DATA(capi_x_tmp));

  /* Processing variable a */
  ;
  capi_a_intent |= F2PY_INTENT_IN;
  capi_a_tmp = array_from_pyobj(NPY_DOUBLE,a_Dims,a_Rank,capi_a_intent,a_capi);
  if (capi_a_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 1st argument `a' of miccs_core.miccs_core_mod.bilinear_same to C/Fortran array" );
  } else {
    a = (double *)(PyArray_DATA(capi_a_tmp));

  /* Processing variable bilinear_same */
  /* Processing variable f2py_a_d0 */
  f2py_a_d0 = shape(a, 0);
  /* Processing variable f2py_a_d1 */
  f2py_a_d1 = shape(a, 1);
  /* Processing variable f2py_x_d0 */
  f2py_x_d0 = shape(x, 0);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
  (*f2py_func)(&bilinear_same,a,x,&f2py_a_d0,&f2py_a_d1,&f2py_x_d0);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("d",bilinear_same);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable f2py_x_d0 */
  /* End of cleaning variable f2py_a_d1 */
  /* End of cleaning variable f2py_a_d0 */
  /* End of cleaning variable bilinear_same */
  if((PyObject *)capi_a_tmp!=a_capi) {
    Py_XDECREF(capi_a_tmp); }
  }  /*if (capi_a_tmp == NULL) ... else of a*/
  /* End of cleaning variable a */
  if((PyObject *)capi_x_tmp!=x_capi) {
    Py_XDECREF(capi_x_tmp); }
  }  /*if (capi_x_tmp == NULL) ... else of x*/
  /* End of cleaning variable x */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/**************************** end of bilinear_same ****************************/

/********************************** bilinear **********************************/
static char doc_f2py_rout_miccs_core_miccs_core_mod_bilinear[] = "\
bilinear = bilinear(x,a,y)\n\nWrapper for ``bilinear``.\
\n\nParameters\n----------\n"
"x : input rank-1 array('d') with bounds (f2py_x_d0)\n"
"a : input rank-2 array('d') with bounds (f2py_a_d0,f2py_a_d1)\n"
"y : input rank-1 array('d') with bounds (f2py_y_d0)\n"
"\nReturns\n-------\n"
"bilinear : float";
/* #declfortranroutine# */
static PyObject *f2py_rout_miccs_core_miccs_core_mod_bilinear(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,int*,int*,int*,int*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  double bilinear = 0;
  double *x = NULL;
  npy_intp x_Dims[1] = {-1};
  const int x_Rank = 1;
  PyArrayObject *capi_x_tmp = NULL;
  int capi_x_intent = 0;
  PyObject *x_capi = Py_None;
  double *a = NULL;
  npy_intp a_Dims[2] = {-1, -1};
  const int a_Rank = 2;
  PyArrayObject *capi_a_tmp = NULL;
  int capi_a_intent = 0;
  PyObject *a_capi = Py_None;
  double *y = NULL;
  npy_intp y_Dims[1] = {-1};
  const int y_Rank = 1;
  PyArrayObject *capi_y_tmp = NULL;
  int capi_y_intent = 0;
  PyObject *y_capi = Py_None;
  int f2py_x_d0 = 0;
  int f2py_a_d0 = 0;
  int f2py_a_d1 = 0;
  int f2py_y_d0 = 0;
  static char *capi_kwlist[] = {"x","a","y",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOO:miccs_core.miccs_core_mod.bilinear",\
    capi_kwlist,&x_capi,&a_capi,&y_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable a */
  ;
  capi_a_intent |= F2PY_INTENT_IN;
  capi_a_tmp = array_from_pyobj(NPY_DOUBLE,a_Dims,a_Rank,capi_a_intent,a_capi);
  if (capi_a_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 2nd argument `a' of miccs_core.miccs_core_mod.bilinear to C/Fortran array" );
  } else {
    a = (double *)(PyArray_DATA(capi_a_tmp));

  /* Processing variable x */
  ;
  capi_x_intent |= F2PY_INTENT_IN;
  capi_x_tmp = array_from_pyobj(NPY_DOUBLE,x_Dims,x_Rank,capi_x_intent,x_capi);
  if (capi_x_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 1st argument `x' of miccs_core.miccs_core_mod.bilinear to C/Fortran array" );
  } else {
    x = (double *)(PyArray_DATA(capi_x_tmp));

  /* Processing variable y */
  ;
  capi_y_intent |= F2PY_INTENT_IN;
  capi_y_tmp = array_from_pyobj(NPY_DOUBLE,y_Dims,y_Rank,capi_y_intent,y_capi);
  if (capi_y_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 3rd argument `y' of miccs_core.miccs_core_mod.bilinear to C/Fortran array" );
  } else {
    y = (double *)(PyArray_DATA(capi_y_tmp));

  /* Processing variable bilinear */
  /* Processing variable f2py_x_d0 */
  f2py_x_d0 = shape(x, 0);
  /* Processing variable f2py_a_d0 */
  f2py_a_d0 = shape(a, 0);
  /* Processing variable f2py_a_d1 */
  f2py_a_d1 = shape(a, 1);
  /* Processing variable f2py_y_d0 */
  f2py_y_d0 = shape(y, 0);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
  (*f2py_func)(&bilinear,x,a,y,&f2py_x_d0,&f2py_a_d0,&f2py_a_d1,&f2py_y_d0);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("d",bilinear);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable f2py_y_d0 */
  /* End of cleaning variable f2py_a_d1 */
  /* End of cleaning variable f2py_a_d0 */
  /* End of cleaning variable f2py_x_d0 */
  /* End of cleaning variable bilinear */
  if((PyObject *)capi_y_tmp!=y_capi) {
    Py_XDECREF(capi_y_tmp); }
  }  /*if (capi_y_tmp == NULL) ... else of y*/
  /* End of cleaning variable y */
  if((PyObject *)capi_x_tmp!=x_capi) {
    Py_XDECREF(capi_x_tmp); }
  }  /*if (capi_x_tmp == NULL) ... else of x*/
  /* End of cleaning variable x */
  if((PyObject *)capi_a_tmp!=a_capi) {
    Py_XDECREF(capi_a_tmp); }
  }  /*if (capi_a_tmp == NULL) ... else of a*/
  /* End of cleaning variable a */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/****************************** end of bilinear ******************************/

/********************************* outer_same *********************************/
static char doc_f2py_rout_miccs_core_miccs_core_mod_outer_same[] = "\
outer_same = outer_same(x)\n\nWrapper for ``outer_same``.\
\n\nParameters\n----------\n"
"x : input rank-1 array('d') with bounds (f2py_x_d0)\n"
"\nReturns\n-------\n"
"outer_same : rank-2 array('d') with bounds (size(x),size(x))";
/* #declfortranroutine# */
static PyObject *f2py_rout_miccs_core_miccs_core_mod_outer_same(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,int*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  double *outer_same = NULL;
  npy_intp outer_same_Dims[2] = {-1, -1};
  const int outer_same_Rank = 2;
  PyArrayObject *capi_outer_same_tmp = NULL;
  int capi_outer_same_intent = 0;
  double *x = NULL;
  npy_intp x_Dims[1] = {-1};
  const int x_Rank = 1;
  PyArrayObject *capi_x_tmp = NULL;
  int capi_x_intent = 0;
  PyObject *x_capi = Py_None;
  int f2py_x_d0 = 0;
  static char *capi_kwlist[] = {"x",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "O:miccs_core.miccs_core_mod.outer_same",\
    capi_kwlist,&x_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable x */
  ;
  capi_x_intent |= F2PY_INTENT_IN;
  capi_x_tmp = array_from_pyobj(NPY_DOUBLE,x_Dims,x_Rank,capi_x_intent,x_capi);
  if (capi_x_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 1st argument `x' of miccs_core.miccs_core_mod.outer_same to C/Fortran array" );
  } else {
    x = (double *)(PyArray_DATA(capi_x_tmp));

  /* Processing variable outer_same */
  outer_same_Dims[0]=size(x),outer_same_Dims[1]=size(x);
  capi_outer_same_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_outer_same_tmp = array_from_pyobj(NPY_DOUBLE,outer_same_Dims,outer_same_Rank,capi_outer_same_intent,Py_None);
  if (capi_outer_same_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting hidden `outer_same' of miccs_core.miccs_core_mod.outer_same to C/Fortran array" );
  } else {
    outer_same = (double *)(PyArray_DATA(capi_outer_same_tmp));

  /* Processing variable f2py_x_d0 */
  f2py_x_d0 = shape(x, 0);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
  (*f2py_func)(outer_same,x,&f2py_x_d0);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("N",capi_outer_same_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable f2py_x_d0 */
  }  /*if (capi_outer_same_tmp == NULL) ... else of outer_same*/
  /* End of cleaning variable outer_same */
  if((PyObject *)capi_x_tmp!=x_capi) {
    Py_XDECREF(capi_x_tmp); }
  }  /*if (capi_x_tmp == NULL) ... else of x*/
  /* End of cleaning variable x */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/***************************** end of outer_same *****************************/

/*********************************** outer ***********************************/
static char doc_f2py_rout_miccs_core_miccs_core_mod_outer[] = "\
outer = outer(x,y)\n\nWrapper for ``outer``.\
\n\nParameters\n----------\n"
"x : input rank-1 array('d') with bounds (f2py_x_d0)\n"
"y : input rank-1 array('d') with bounds (f2py_y_d0)\n"
"\nReturns\n-------\n"
"outer : rank-2 array('d') with bounds (size(x),size(y))";
/* #declfortranroutine# */
static PyObject *f2py_rout_miccs_core_miccs_core_mod_outer(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,int*,int*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  double *outer = NULL;
  npy_intp outer_Dims[2] = {-1, -1};
  const int outer_Rank = 2;
  PyArrayObject *capi_outer_tmp = NULL;
  int capi_outer_intent = 0;
  double *x = NULL;
  npy_intp x_Dims[1] = {-1};
  const int x_Rank = 1;
  PyArrayObject *capi_x_tmp = NULL;
  int capi_x_intent = 0;
  PyObject *x_capi = Py_None;
  double *y = NULL;
  npy_intp y_Dims[1] = {-1};
  const int y_Rank = 1;
  PyArrayObject *capi_y_tmp = NULL;
  int capi_y_intent = 0;
  PyObject *y_capi = Py_None;
  int f2py_x_d0 = 0;
  int f2py_y_d0 = 0;
  static char *capi_kwlist[] = {"x","y",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OO:miccs_core.miccs_core_mod.outer",\
    capi_kwlist,&x_capi,&y_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable x */
  ;
  capi_x_intent |= F2PY_INTENT_IN;
  capi_x_tmp = array_from_pyobj(NPY_DOUBLE,x_Dims,x_Rank,capi_x_intent,x_capi);
  if (capi_x_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 1st argument `x' of miccs_core.miccs_core_mod.outer to C/Fortran array" );
  } else {
    x = (double *)(PyArray_DATA(capi_x_tmp));

  /* Processing variable y */
  ;
  capi_y_intent |= F2PY_INTENT_IN;
  capi_y_tmp = array_from_pyobj(NPY_DOUBLE,y_Dims,y_Rank,capi_y_intent,y_capi);
  if (capi_y_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 2nd argument `y' of miccs_core.miccs_core_mod.outer to C/Fortran array" );
  } else {
    y = (double *)(PyArray_DATA(capi_y_tmp));

  /* Processing variable outer */
  outer_Dims[0]=size(x),outer_Dims[1]=size(y);
  capi_outer_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_outer_tmp = array_from_pyobj(NPY_DOUBLE,outer_Dims,outer_Rank,capi_outer_intent,Py_None);
  if (capi_outer_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting hidden `outer' of miccs_core.miccs_core_mod.outer to C/Fortran array" );
  } else {
    outer = (double *)(PyArray_DATA(capi_outer_tmp));

  /* Processing variable f2py_x_d0 */
  f2py_x_d0 = shape(x, 0);
  /* Processing variable f2py_y_d0 */
  f2py_y_d0 = shape(y, 0);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
  (*f2py_func)(outer,x,y,&f2py_x_d0,&f2py_y_d0);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("N",capi_outer_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable f2py_y_d0 */
  /* End of cleaning variable f2py_x_d0 */
  }  /*if (capi_outer_tmp == NULL) ... else of outer*/
  /* End of cleaning variable outer */
  if((PyObject *)capi_y_tmp!=y_capi) {
    Py_XDECREF(capi_y_tmp); }
  }  /*if (capi_y_tmp == NULL) ... else of y*/
  /* End of cleaning variable y */
  if((PyObject *)capi_x_tmp!=x_capi) {
    Py_XDECREF(capi_x_tmp); }
  }  /*if (capi_x_tmp == NULL) ... else of x*/
  /* End of cleaning variable x */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/******************************** end of outer ********************************/

/********************************** cov_same **********************************/
static char doc_f2py_rout_miccs_core_miccs_core_mod_cov_same[] = "\
cov_same = cov_same(x)\n\nWrapper for ``cov_same``.\
\n\nParameters\n----------\n"
"x : input rank-2 array('d') with bounds (f2py_x_d0,f2py_x_d1)\n"
"\nReturns\n-------\n"
"cov_same : rank-2 array('d') with bounds (size(x,1),size(x,1))";
/* #declfortranroutine# */
static PyObject *f2py_rout_miccs_core_miccs_core_mod_cov_same(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,int*,int*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  double *cov_same = NULL;
  npy_intp cov_same_Dims[2] = {-1, -1};
  const int cov_same_Rank = 2;
  PyArrayObject *capi_cov_same_tmp = NULL;
  int capi_cov_same_intent = 0;
  double *x = NULL;
  npy_intp x_Dims[2] = {-1, -1};
  const int x_Rank = 2;
  PyArrayObject *capi_x_tmp = NULL;
  int capi_x_intent = 0;
  PyObject *x_capi = Py_None;
  int f2py_x_d0 = 0;
  int f2py_x_d1 = 0;
  static char *capi_kwlist[] = {"x",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "O:miccs_core.miccs_core_mod.cov_same",\
    capi_kwlist,&x_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable x */
  ;
  capi_x_intent |= F2PY_INTENT_IN;
  capi_x_tmp = array_from_pyobj(NPY_DOUBLE,x_Dims,x_Rank,capi_x_intent,x_capi);
  if (capi_x_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 1st argument `x' of miccs_core.miccs_core_mod.cov_same to C/Fortran array" );
  } else {
    x = (double *)(PyArray_DATA(capi_x_tmp));

  /* Processing variable cov_same */
  cov_same_Dims[0]=size(x,1),cov_same_Dims[1]=size(x,1);
  capi_cov_same_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_cov_same_tmp = array_from_pyobj(NPY_DOUBLE,cov_same_Dims,cov_same_Rank,capi_cov_same_intent,Py_None);
  if (capi_cov_same_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting hidden `cov_same' of miccs_core.miccs_core_mod.cov_same to C/Fortran array" );
  } else {
    cov_same = (double *)(PyArray_DATA(capi_cov_same_tmp));

  /* Processing variable f2py_x_d0 */
  f2py_x_d0 = shape(x, 0);
  /* Processing variable f2py_x_d1 */
  f2py_x_d1 = shape(x, 1);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
  (*f2py_func)(cov_same,x,&f2py_x_d0,&f2py_x_d1);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("N",capi_cov_same_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable f2py_x_d1 */
  /* End of cleaning variable f2py_x_d0 */
  }  /*if (capi_cov_same_tmp == NULL) ... else of cov_same*/
  /* End of cleaning variable cov_same */
  if((PyObject *)capi_x_tmp!=x_capi) {
    Py_XDECREF(capi_x_tmp); }
  }  /*if (capi_x_tmp == NULL) ... else of x*/
  /* End of cleaning variable x */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/****************************** end of cov_same ******************************/

/************************************ cov ************************************/
static char doc_f2py_rout_miccs_core_miccs_core_mod_cov[] = "\
cov = cov(x,y)\n\nWrapper for ``cov``.\
\n\nParameters\n----------\n"
"x : input rank-2 array('d') with bounds (f2py_x_d0,f2py_x_d1)\n"
"y : input rank-2 array('d') with bounds (f2py_y_d0,f2py_y_d1)\n"
"\nReturns\n-------\n"
"cov : rank-2 array('d') with bounds (size(x,1),size(y,1))";
/* #declfortranroutine# */
static PyObject *f2py_rout_miccs_core_miccs_core_mod_cov(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,int*,int*,int*,int*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  double *cov = NULL;
  npy_intp cov_Dims[2] = {-1, -1};
  const int cov_Rank = 2;
  PyArrayObject *capi_cov_tmp = NULL;
  int capi_cov_intent = 0;
  double *x = NULL;
  npy_intp x_Dims[2] = {-1, -1};
  const int x_Rank = 2;
  PyArrayObject *capi_x_tmp = NULL;
  int capi_x_intent = 0;
  PyObject *x_capi = Py_None;
  double *y = NULL;
  npy_intp y_Dims[2] = {-1, -1};
  const int y_Rank = 2;
  PyArrayObject *capi_y_tmp = NULL;
  int capi_y_intent = 0;
  PyObject *y_capi = Py_None;
  int f2py_x_d0 = 0;
  int f2py_x_d1 = 0;
  int f2py_y_d0 = 0;
  int f2py_y_d1 = 0;
  static char *capi_kwlist[] = {"x","y",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OO:miccs_core.miccs_core_mod.cov",\
    capi_kwlist,&x_capi,&y_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable x */
  ;
  capi_x_intent |= F2PY_INTENT_IN;
  capi_x_tmp = array_from_pyobj(NPY_DOUBLE,x_Dims,x_Rank,capi_x_intent,x_capi);
  if (capi_x_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 1st argument `x' of miccs_core.miccs_core_mod.cov to C/Fortran array" );
  } else {
    x = (double *)(PyArray_DATA(capi_x_tmp));

  /* Processing variable y */
  ;
  capi_y_intent |= F2PY_INTENT_IN;
  capi_y_tmp = array_from_pyobj(NPY_DOUBLE,y_Dims,y_Rank,capi_y_intent,y_capi);
  if (capi_y_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 2nd argument `y' of miccs_core.miccs_core_mod.cov to C/Fortran array" );
  } else {
    y = (double *)(PyArray_DATA(capi_y_tmp));

  /* Processing variable cov */
  cov_Dims[0]=size(x,1),cov_Dims[1]=size(y,1);
  capi_cov_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_cov_tmp = array_from_pyobj(NPY_DOUBLE,cov_Dims,cov_Rank,capi_cov_intent,Py_None);
  if (capi_cov_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting hidden `cov' of miccs_core.miccs_core_mod.cov to C/Fortran array" );
  } else {
    cov = (double *)(PyArray_DATA(capi_cov_tmp));

  /* Processing variable f2py_x_d0 */
  f2py_x_d0 = shape(x, 0);
  /* Processing variable f2py_x_d1 */
  f2py_x_d1 = shape(x, 1);
  /* Processing variable f2py_y_d0 */
  f2py_y_d0 = shape(y, 0);
  /* Processing variable f2py_y_d1 */
  f2py_y_d1 = shape(y, 1);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
  (*f2py_func)(cov,x,y,&f2py_x_d0,&f2py_x_d1,&f2py_y_d0,&f2py_y_d1);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("N",capi_cov_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable f2py_y_d1 */
  /* End of cleaning variable f2py_y_d0 */
  /* End of cleaning variable f2py_x_d1 */
  /* End of cleaning variable f2py_x_d0 */
  }  /*if (capi_cov_tmp == NULL) ... else of cov*/
  /* End of cleaning variable cov */
  if((PyObject *)capi_y_tmp!=y_capi) {
    Py_XDECREF(capi_y_tmp); }
  }  /*if (capi_y_tmp == NULL) ... else of y*/
  /* End of cleaning variable y */
  if((PyObject *)capi_x_tmp!=x_capi) {
    Py_XDECREF(capi_x_tmp); }
  }  /*if (capi_x_tmp == NULL) ... else of x*/
  /* End of cleaning variable x */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/********************************* end of cov *********************************/

/************************************ inv ************************************/
static char doc_f2py_rout_miccs_core_miccs_core_mod_inv[] = "\
inv = inv(a)\n\nWrapper for ``inv``.\
\n\nParameters\n----------\n"
"a : input rank-2 array('d') with bounds (f2py_a_d0,f2py_a_d1)\n"
"\nReturns\n-------\n"
"inv : rank-2 array('d') with bounds (size(a,1),size(a,2))";
/* #declfortranroutine# */
static PyObject *f2py_rout_miccs_core_miccs_core_mod_inv(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,int*,int*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  double *inv = NULL;
  npy_intp inv_Dims[2] = {-1, -1};
  const int inv_Rank = 2;
  PyArrayObject *capi_inv_tmp = NULL;
  int capi_inv_intent = 0;
  double *a = NULL;
  npy_intp a_Dims[2] = {-1, -1};
  const int a_Rank = 2;
  PyArrayObject *capi_a_tmp = NULL;
  int capi_a_intent = 0;
  PyObject *a_capi = Py_None;
  int f2py_a_d0 = 0;
  int f2py_a_d1 = 0;
  static char *capi_kwlist[] = {"a",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "O:miccs_core.miccs_core_mod.inv",\
    capi_kwlist,&a_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable a */
  ;
  capi_a_intent |= F2PY_INTENT_IN;
  capi_a_tmp = array_from_pyobj(NPY_DOUBLE,a_Dims,a_Rank,capi_a_intent,a_capi);
  if (capi_a_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 1st argument `a' of miccs_core.miccs_core_mod.inv to C/Fortran array" );
  } else {
    a = (double *)(PyArray_DATA(capi_a_tmp));

  /* Processing variable inv */
  inv_Dims[0]=size(a,1),inv_Dims[1]=size(a,2);
  capi_inv_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_inv_tmp = array_from_pyobj(NPY_DOUBLE,inv_Dims,inv_Rank,capi_inv_intent,Py_None);
  if (capi_inv_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting hidden `inv' of miccs_core.miccs_core_mod.inv to C/Fortran array" );
  } else {
    inv = (double *)(PyArray_DATA(capi_inv_tmp));

  /* Processing variable f2py_a_d0 */
  f2py_a_d0 = shape(a, 0);
  /* Processing variable f2py_a_d1 */
  f2py_a_d1 = shape(a, 1);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
  (*f2py_func)(inv,a,&f2py_a_d0,&f2py_a_d1);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("N",capi_inv_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable f2py_a_d1 */
  /* End of cleaning variable f2py_a_d0 */
  }  /*if (capi_inv_tmp == NULL) ... else of inv*/
  /* End of cleaning variable inv */
  if((PyObject *)capi_a_tmp!=a_capi) {
    Py_XDECREF(capi_a_tmp); }
  }  /*if (capi_a_tmp == NULL) ... else of a*/
  /* End of cleaning variable a */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/********************************* end of inv *********************************/

/************************************ det ************************************/
static char doc_f2py_rout_miccs_core_miccs_core_mod_det[] = "\
det = det(a)\n\nWrapper for ``det``.\
\n\nParameters\n----------\n"
"a : input rank-2 array('d') with bounds (f2py_a_d0,f2py_a_d1)\n"
"\nReturns\n-------\n"
"det : float";
/* #declfortranroutine# */
static PyObject *f2py_rout_miccs_core_miccs_core_mod_det(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,int*,int*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  double det = 0;
  double *a = NULL;
  npy_intp a_Dims[2] = {-1, -1};
  const int a_Rank = 2;
  PyArrayObject *capi_a_tmp = NULL;
  int capi_a_intent = 0;
  PyObject *a_capi = Py_None;
  int f2py_a_d0 = 0;
  int f2py_a_d1 = 0;
  static char *capi_kwlist[] = {"a",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "O:miccs_core.miccs_core_mod.det",\
    capi_kwlist,&a_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable a */
  ;
  capi_a_intent |= F2PY_INTENT_IN;
  capi_a_tmp = array_from_pyobj(NPY_DOUBLE,a_Dims,a_Rank,capi_a_intent,a_capi);
  if (capi_a_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 1st argument `a' of miccs_core.miccs_core_mod.det to C/Fortran array" );
  } else {
    a = (double *)(PyArray_DATA(capi_a_tmp));

  /* Processing variable det */
  /* Processing variable f2py_a_d0 */
  f2py_a_d0 = shape(a, 0);
  /* Processing variable f2py_a_d1 */
  f2py_a_d1 = shape(a, 1);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
  (*f2py_func)(&det,a,&f2py_a_d0,&f2py_a_d1);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("d",det);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable f2py_a_d1 */
  /* End of cleaning variable f2py_a_d0 */
  /* End of cleaning variable det */
  if((PyObject *)capi_a_tmp!=a_capi) {
    Py_XDECREF(capi_a_tmp); }
  }  /*if (capi_a_tmp == NULL) ... else of a*/
  /* End of cleaning variable a */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/********************************* end of det *********************************/

/************************************* tr *************************************/
static char doc_f2py_rout_miccs_core_miccs_core_mod_tr[] = "\
tr = tr(x)\n\nWrapper for ``tr``.\
\n\nParameters\n----------\n"
"x : input rank-2 array('d') with bounds (f2py_x_d0,f2py_x_d1)\n"
"\nReturns\n-------\n"
"tr : float";
/* #declfortranroutine# */
static PyObject *f2py_rout_miccs_core_miccs_core_mod_tr(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,int*,int*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  double tr = 0;
  double *x = NULL;
  npy_intp x_Dims[2] = {-1, -1};
  const int x_Rank = 2;
  PyArrayObject *capi_x_tmp = NULL;
  int capi_x_intent = 0;
  PyObject *x_capi = Py_None;
  int f2py_x_d0 = 0;
  int f2py_x_d1 = 0;
  static char *capi_kwlist[] = {"x",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "O:miccs_core.miccs_core_mod.tr",\
    capi_kwlist,&x_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable x */
  ;
  capi_x_intent |= F2PY_INTENT_IN;
  capi_x_tmp = array_from_pyobj(NPY_DOUBLE,x_Dims,x_Rank,capi_x_intent,x_capi);
  if (capi_x_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(miccs_core_error,"failed in converting 1st argument `x' of miccs_core.miccs_core_mod.tr to C/Fortran array" );
  } else {
    x = (double *)(PyArray_DATA(capi_x_tmp));

  /* Processing variable tr */
  /* Processing variable f2py_x_d0 */
  f2py_x_d0 = shape(x, 0);
  /* Processing variable f2py_x_d1 */
  f2py_x_d1 = shape(x, 1);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
  (*f2py_func)(&tr,x,&f2py_x_d0,&f2py_x_d1);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("d",tr);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable f2py_x_d1 */
  /* End of cleaning variable f2py_x_d0 */
  /* End of cleaning variable tr */
  if((PyObject *)capi_x_tmp!=x_capi) {
    Py_XDECREF(capi_x_tmp); }
  }  /*if (capi_x_tmp == NULL) ... else of x*/
  /* End of cleaning variable x */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/********************************* end of tr *********************************/

/************************************ sgn ************************************/
static char doc_f2py_rout_miccs_core_miccs_core_mod_sgn[] = "\
sgn = sgn(x)\n\nWrapper for ``sgn``.\
\n\nParameters\n----------\n"
"x : input float\n"
"\nReturns\n-------\n"
"sgn : float";
/* #declfortranroutine# */
static PyObject *f2py_rout_miccs_core_miccs_core_mod_sgn(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  double sgn = 0;
  double x = 0;
  PyObject *x_capi = Py_None;
  static char *capi_kwlist[] = {"x",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "O:miccs_core.miccs_core_mod.sgn",\
    capi_kwlist,&x_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable x */
    f2py_success = double_from_pyobj(&x,x_capi,"miccs_core.miccs_core_mod.sgn() 1st argument (x) can't be converted to double");
  if (f2py_success) {
  /* Processing variable sgn */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
  (*f2py_func)(&sgn,&x);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("d",sgn);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable sgn */
  } /*if (f2py_success) of x*/
  /* End of cleaning variable x */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/********************************* end of sgn *********************************/
/*eof body*/

/******************* See f2py2e/f90mod_rules.py: buildhooks *******************/

static FortranDataDef f2py_miccs_core_mod_def[] = {
  {"vecmat",-1,{{-1}},0,NULL,(void *)f2py_rout_miccs_core_miccs_core_mod_vecmat,doc_f2py_rout_miccs_core_miccs_core_mod_vecmat},
  {"matvec",-1,{{-1}},0,NULL,(void *)f2py_rout_miccs_core_miccs_core_mod_matvec,doc_f2py_rout_miccs_core_miccs_core_mod_matvec},
  {"bilinear_same",-1,{{-1}},0,NULL,(void *)f2py_rout_miccs_core_miccs_core_mod_bilinear_same,doc_f2py_rout_miccs_core_miccs_core_mod_bilinear_same},
  {"bilinear",-1,{{-1}},0,NULL,(void *)f2py_rout_miccs_core_miccs_core_mod_bilinear,doc_f2py_rout_miccs_core_miccs_core_mod_bilinear},
  {"outer_same",-1,{{-1}},0,NULL,(void *)f2py_rout_miccs_core_miccs_core_mod_outer_same,doc_f2py_rout_miccs_core_miccs_core_mod_outer_same},
  {"outer",-1,{{-1}},0,NULL,(void *)f2py_rout_miccs_core_miccs_core_mod_outer,doc_f2py_rout_miccs_core_miccs_core_mod_outer},
  {"cov_same",-1,{{-1}},0,NULL,(void *)f2py_rout_miccs_core_miccs_core_mod_cov_same,doc_f2py_rout_miccs_core_miccs_core_mod_cov_same},
  {"cov",-1,{{-1}},0,NULL,(void *)f2py_rout_miccs_core_miccs_core_mod_cov,doc_f2py_rout_miccs_core_miccs_core_mod_cov},
  {"inv",-1,{{-1}},0,NULL,(void *)f2py_rout_miccs_core_miccs_core_mod_inv,doc_f2py_rout_miccs_core_miccs_core_mod_inv},
  {"det",-1,{{-1}},0,NULL,(void *)f2py_rout_miccs_core_miccs_core_mod_det,doc_f2py_rout_miccs_core_miccs_core_mod_det},
  {"tr",-1,{{-1}},0,NULL,(void *)f2py_rout_miccs_core_miccs_core_mod_tr,doc_f2py_rout_miccs_core_miccs_core_mod_tr},
  {"sgn",-1,{{-1}},0,NULL,(void *)f2py_rout_miccs_core_miccs_core_mod_sgn,doc_f2py_rout_miccs_core_miccs_core_mod_sgn},
  {NULL}
};

static void f2py_setup_miccs_core_mod(char *vecmat,char *matvec,char *bilinear_same,char *bilinear,char *outer_same,char *outer,char *cov_same,char *cov,char *inv,char *det,char *tr,char *sgn) {
  int i_f2py=0;
  f2py_miccs_core_mod_def[i_f2py++].data = vecmat;
  f2py_miccs_core_mod_def[i_f2py++].data = matvec;
  f2py_miccs_core_mod_def[i_f2py++].data = bilinear_same;
  f2py_miccs_core_mod_def[i_f2py++].data = bilinear;
  f2py_miccs_core_mod_def[i_f2py++].data = outer_same;
  f2py_miccs_core_mod_def[i_f2py++].data = outer;
  f2py_miccs_core_mod_def[i_f2py++].data = cov_same;
  f2py_miccs_core_mod_def[i_f2py++].data = cov;
  f2py_miccs_core_mod_def[i_f2py++].data = inv;
  f2py_miccs_core_mod_def[i_f2py++].data = det;
  f2py_miccs_core_mod_def[i_f2py++].data = tr;
  f2py_miccs_core_mod_def[i_f2py++].data = sgn;
}
extern void F_FUNC_US(f2pyinitmiccs_core_mod,F2PYINITMICCS_CORE_MOD)(void (*)(char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *));
static void f2py_init_miccs_core_mod(void) {
  F_FUNC_US(f2pyinitmiccs_core_mod,F2PYINITMICCS_CORE_MOD)(f2py_setup_miccs_core_mod);
}

/*need_f90modhooks*/

/************** See f2py2e/rules.py: module_rules['modulebody'] **************/

/******************* See f2py2e/common_rules.py: buildhooks *******************/

/*need_commonhooks*/

/**************************** See f2py2e/rules.py ****************************/

static FortranDataDef f2py_routine_defs[] = {
  {"optimize_once",-1,{{-1}},0,(char *)F_FUNC_US(optimize_once,OPTIMIZE_ONCE),(f2py_init_func)f2py_rout_miccs_core_optimize_once,doc_f2py_rout_miccs_core_optimize_once},

/*eof routine_defs*/
  {NULL}
};

static PyMethodDef f2py_module_methods[] = {

  {NULL,NULL}
};

#if PY_VERSION_HEX >= 0x03000000
static struct PyModuleDef moduledef = {
  PyModuleDef_HEAD_INIT,
  "miccs_core",
  NULL,
  -1,
  f2py_module_methods,
  NULL,
  NULL,
  NULL,
  NULL
};
#endif

#if PY_VERSION_HEX >= 0x03000000
#define RETVAL m
PyMODINIT_FUNC PyInit_miccs_core(void) {
#else
#define RETVAL
PyMODINIT_FUNC initmiccs_core(void) {
#endif
  int i;
  PyObject *m,*d, *s;
#if PY_VERSION_HEX >= 0x03000000
  m = miccs_core_module = PyModule_Create(&moduledef);
#else
  m = miccs_core_module = Py_InitModule("miccs_core", f2py_module_methods);
#endif
  Py_TYPE(&PyFortran_Type) = &PyType_Type;
  import_array();
  if (PyErr_Occurred())
    {PyErr_SetString(PyExc_ImportError, "can't initialize module miccs_core (failed to import numpy)"); return RETVAL;}
  d = PyModule_GetDict(m);
  s = PyString_FromString("$Revision: $");
  PyDict_SetItemString(d, "__version__", s);
#if PY_VERSION_HEX >= 0x03000000
  s = PyUnicode_FromString(
#else
  s = PyString_FromString(
#endif
    "This module 'miccs_core' is auto-generated with f2py (version:2).\nFunctions:\n"
"  cost = optimize_once(prec,weight,latent,corr,obs,ind,full_graph,smooth_graph,lglasso,lridge,lsmooth,npop=shape(prec,0),dtot=len(weight),nobs=shape(latent,1))\n"
"Fortran 90/95 modules:\n""  miccs_core_mod --- vecmat(),matvec(),bilinear_same(),bilinear(),outer_same(),outer(),cov_same(),cov(),inv(),det(),tr(),sgn()"".");
  PyDict_SetItemString(d, "__doc__", s);
  miccs_core_error = PyErr_NewException ("miccs_core.error", NULL, NULL);
  Py_DECREF(s);
  for(i=0;f2py_routine_defs[i].name!=NULL;i++)
    PyDict_SetItemString(d, f2py_routine_defs[i].name,PyFortranObject_NewAsAttr(&f2py_routine_defs[i]));













/*eof initf2pywraphooks*/
  PyDict_SetItemString(d, "miccs_core_mod", PyFortranObject_New(f2py_miccs_core_mod_def,f2py_init_miccs_core_mod));
/*eof initf90modhooks*/

/*eof initcommonhooks*/


#ifdef F2PY_REPORT_ATEXIT
  if (! PyErr_Occurred())
    on_exit(f2py_report_on_exit,(void*)"miccs_core");
#endif

  return RETVAL;
}
#ifdef __cplusplus
}
#endif
